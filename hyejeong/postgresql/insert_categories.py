import os
import psycopg2
from dotenv import load_dotenv

# 환경 변수 로드
load_dotenv()
DATABASE_URL = os.getenv("DATABASE_URL")

# DB 연결
conn = psycopg2.connect(DATABASE_URL)
cur = conn.cursor()

# Category 데이터 삽입
cur.execute("""
    INSERT INTO category (id, asset_class, asset_type, asset_subtype, full_path) VALUES
    (1, '주식', '시장대표', NULL, '주식-시장대표'),
    (2, '주식', '업종섹터', NULL, '주식-업종섹터'),
    (3, '주식', '업종섹터', '건설', '주식-업종섹터-건설'),
    (4, '주식', '업종섹터', '중공업', '주식-업종섹터-중공업'),
    (5, '주식', '업종섹터', '산업재', '주식-업종섹터-산업재'),
    (6, '주식', '업종섹터', '금융', '주식-업종섹터-금융'),
    (7, '주식', '업종섹터', '에너지화학', '주식-업종섹터-에너지화학'),
    (8, '주식', '업종섹터', '경기소비재', '주식-업종섹터-경기소비재'),
    (9, '주식', '업종섹터', '생활소비재', '주식-업종섹터-생활소비재'),
    (10, '주식', '업종섹터', '헬스케어', '주식-업종섹터-헬스케어'),
    (11, '주식', '업종섹터', '정보기술', '주식-업종섹터-정보기술'),
    (12, '주식', '업종섹터', '철강소재', '주식-업종섹터-철강소재'),
    (13, '주식', '업종섹터', '업종테마', '주식-업종섹터-업종테마'),
    (14, '주식', '업종섹터', '커뮤니케이션서비스', '주식-업종섹터-커뮤니케이션서비스'),
    (15, '주식', '전략', '가치', '주식-전략-가치'),
    (16, '주식', '전략', '성장', '주식-전략-성장'),
    (17, '주식', '전략', '배당', '주식-전략-배당'),
    (18, '주식', '전략', '변동성', '주식-전략-변동성'),
    (19, '주식', '전략', '구조화', '주식-전략-구조화'),
    (20, '주식', '전략', '기업그룹', '주식-전략-기업그룹'),
    (21, '주식', '전략', '전략테마', '주식-전략-전략테마'),
    (22, '주식', '전략', '혼합/퀀트', '주식-전략-혼합/퀀트'),
    (23, '주식', '규모', '대형주', '주식-규모-대형주'),
    (24, '주식', '규모', '중형주', '주식-규모-중형주')
    ON CONFLICT (id) DO NOTHING;
""")

conn.commit()
print("✅ Category 데이터 삽입 완료")

cur.close()
conn.close()
